## ä¸ªäººåšå®¢

æŠ€æœ¯ç»„åˆï¼š

- åç«¯ï¼šSpringBoot + JPA + thymeleafæ¨¡å—
- æ•°æ®åº“ï¼šMySQL
- å‰æ®µUIï¼š Semantic UI æ¡†æ¶



å·¥å…·ä¸ç¯å¢ƒï¼š

- IDEA
- Maven 5.6
- JDK8
- Axure RP 8

## 1ã€éœ€æ±‚ä¸åŠŸèƒ½

è§’è‰²ï¼šæ™®é€šè®¿å®¢ã€ç®¡ç†å‘˜ï¼ˆæˆ‘ï¼‰

è®¿å®¢ï¼š

- å¯ä»¥åˆ†é¡µæŸ¥çœ‹æ‰€æœ‰çš„åšå®¢
- å¯ä»¥å¿«é€ŸæŸ¥çœ‹åšå®¢æ•°æœ€å¤šçš„6ä¸ªåˆ†ç±»
- å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„åˆ†ç±»
- å¯ä»¥æŸ¥çœ‹æ ‡è®°åšå®¢æœ€å¤šçš„10ä¸ªæ ‡ç­¾
- å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„æ ‡ç­¾
- å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾ä¸‹çš„åšå®¢åˆ—è¡¨
- å¯ä»¥æ ¹æ®å¹´åº¦æ—¶é—´çº¿æŸ¥çœ‹åšå®¢åˆ—è¡¨
- å¯ä»¥å¿«é€ŸæŸ¥çœ‹æœ€æ–°çš„æ¨èåšå®¢
- å¯ä»¥ä½¿ç”¨å…³é”®å­—å…¨å±€æœç´¢åšå®¢
- å¯ä»¥æŸ¥çœ‹å•ä¸ªåšå®¢å†…å®¹
- å¯ä»¥å¯¹åšå®¢å†…å®¹è¿›è¡Œè¯„è®º
- å¯ä»¥èµèµåšå®¢å†…å®¹
- å¯ä»¥å¾®ä¿¡æ‰«æé˜…è¯»åšå®¢å†…å®¹
- å¯ä»¥åœ¨é¦–é¡µæ‰«æå…¬ä¼—å·ã€äºŒç»´ç å…³æ³¨æˆ‘

ç®¡ç†å‘˜

- å¯ä»¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•åå°ç®¡ç†
- ç®¡ç†åšå®¢
  - å‘å¸ƒæ–°åšå®¢
  - å¯¹åšå®¢è¿›è¡Œåˆ†ç±»
  - å¯¹åšå®¢æ‰“æ ‡ç­¾
  - ä¿®æ”¹åšå®¢
  - åˆ é™¤åšå®¢
  - æ ¹æ®æ ‡é¢˜ï¼Œåˆ†ç±»ï¼Œæ ‡ç­¾æŸ¥è¯¢åšå®¢
- åšå®¢åˆ†ç±»
  - æ–°å¢
  - ä¿®æ”¹
  - æ’å…¥
  - åˆ é™¤
- ç®¡ç†æ ‡ç­¾
  - æ–°å¢
  - ä¿®æ”¹
  - åˆ é™¤
  - æŸ¥æ–° 

## 2ã€æ€ç»´å¯¼å›¾



![image-20220624183433419](image-20220624183433419.png)



## 3ã€é¡µé¢è®¾è®¡ä¸å¼€å‘



å‰æ®µå±•ç¤ºï¼šé¦–é¡µã€è¯¦æƒ…é¡µã€åˆ†ç±»ã€æ ‡ç­¾ã€å½’æ¡£ã€å…³äºæˆ‘

åç«¯ç®¡ç†ï¼šæ¨¡æ¿é¡µ





## 4ã€æ’ä»¶å¼•å…¥

1ã€Markdownç¼–è¾‘å™¨

 [Editor.md - å¼€æºåœ¨çº¿ Markdown ç¼–è¾‘å™¨ (pandao.github.io)](https://pandao.github.io/editor.md/)

2ã€æ’ç‰ˆ

 [sofish/typo.css: ä¸­æ–‡ç½‘é¡µé‡è®¾ä¸æ’ç‰ˆï¼šä¸€è‡´åŒ–æµè§ˆå™¨æ’ç‰ˆæ•ˆæœï¼Œæ„å»ºæœ€é€‚åˆä¸­æ–‡é˜…è¯»çš„ç½‘é¡µæ’ç‰ˆ (github.com)](https://github.com/sofish/typo.css)

3ã€åŠ¨ç”»

 [animate-css/animate.css: ğŸ¿ A cross-browser library of CSS animations. As easy to use as an easy thing. (github.com)](https://github.com/animate-css/animate.css)

4ã€ä»£ç é«˜äº®

[Prism (prismjs.com)](https://prismjs.com/)

5ã€ç›®å½•ç”Ÿæˆ

6ã€äºŒç»´ç æ’ä»¶

[davidshimjs/qrcodejs: Cross-browser QRCode generator for javascript (github.com)](https://github.com/davidshimjs/qrcodejs)

7ã€å¹³æ»‘æ»šåŠ¨

[flesler/jquery.scrollTo: Lightweight, cross-browser and highly customizable animated scrolling with jQuery (github.com)](https://github.com/flesler/jquery.scrollTo)

8ã€æ»šåŠ¨ä¾¦æµ‹

[Waypoints (imakewebthings.com)](http://imakewebthings.com/waypoints/)



## =======åç«¯éƒ¨åˆ†=======

## 5ã€æ¡†æ¶æ­å»º

### 1ã€å¼•å…¥Spring Bootæ¨¡å—

- web
- Thymeleaf
- JAP /Mybatis
- MySQL
- Aspects
- DevTools

### 2ã€application.yaml é…ç½®



```yaml
# æ•°æ®åº“é“¾æ¥
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://47.94.220.33:3306/blog?useUnicode=true&characterEncoding=utf-8
    username: root
    password: 123456

# MyBatisé…ç½®
mybatis:
  # æœç´¢æŒ‡å®šåŒ…åˆ«å
  typeAliasesPackage: com.ruoyi.**.domain
  # é…ç½®mapperçš„æ‰«æï¼Œæ‰¾åˆ°æ‰€æœ‰çš„mapper.xmlæ˜ å°„æ–‡ä»¶
  mapperLocations: classpath*:mapper/**/*Mapper.xml
  # åŠ è½½å…¨å±€çš„é…ç½®æ–‡ä»¶
  configLocation: classpath:mybatis/mybatis-config.xml

# æ—¥å¿—
logging:
  level:
    root: info
    com.wukong: debug
```

### 3ã€logback-spring.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!--    åŒ…å«Springbootå¯¹logbackæ—¥å¿—çš„é»˜è®¤é…ç½®-->
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />
    <property name="LOG_FILE" value="${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}/spring.log}"/>
    <include resource="org/springframework/boot/logging/logback/console-appender.xml" />
    <!--    é‡å†™org/springframework/boot/logging/file-appender.xml-->
    <appender name="TIME_FILE"
              class="ch.qos.logback.core.rolling.RollingFileAppender">
        <encoder>
            <pattern>${FILE_LOG_PATTERN}</pattern>
        </encoder>
        <file>${LOG_FILE}</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOG_FILE}.%d{yyyy-MM-dd}.%i</fileNamePattern>
            <!--  ä¿ç•™æ—¶é—´_å¤©-->
            <maxHistory>30</maxHistory>
            <!--  åˆ†å‰²å¤§å°-->
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>10MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
        </rollingPolicy>
    </appender>
    <root level="INFO">
        <appender-ref ref="CONSOLE"></appender-ref>
        <appender-ref ref="TIME_FILE"></appender-ref>
    </root>

</configuration>
```

## 6ã€å¼‚å¸¸å¤„ç†

### 1ã€å®šä¹‰å¼‚å¸¸å¤„ç†é¡µé¢

- 404 ï¼ˆé¡µé¢èµ„æºæ‰¾ä¸åˆ°ï¼‰
- 500 ï¼ˆSpringåå°é”™è¯¯ä¿¡æ¯ï¼‰
- error ï¼ˆè‡ªå·±å®šä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼‰



### 2ã€é”™è¯¯é¡µé¢æ‹¦æˆªç±»



```java
/**
 * é”™è¯¯é¡µé¢æ‹¦æˆªç±»
 * @ControllerAdvice ä¼šæ‹¦æˆªåˆ°æ‰€æœ‰æ ‡æ³¨ @Controllerçš„ç±»
 */
@ControllerAdvice
public class ControllerExceptionHandler {

    private Logger logger = LoggerFactory.getLogger(this.getClass());

    /**
     * æ‹¦æˆªé”™è¯¯å¹¶è¿”å›åˆ° erroré¡µé¢
     * @ExceptionHandler(Exception.class) å¼‚å¸¸å¤„ç†æ³¨è§£ï¼Œé‡Œé¢çš„å‚æ•°æ˜¯æ‹¦æˆªExceptionçº§åˆ«çš„é”™è¯¯ä¿¡æ¯
     * @param request
     * @param e
     * @return
     */
    @ExceptionHandler(Exception.class)
    public ModelAndView exceptionHandler(HttpServletRequest request,Exception e){

        logger.error("Request URL: {}, Exception: {}",request.getRequestURL(),e);

        ModelAndView mv = new ModelAndView();
        //æ·»åŠ å¼‚å¸¸ä¿¡æ¯
        mv.addObject("url",request.getRequestURL());
        mv.addObject("exception",e);
        //è®¾ç½®è¿”å›é¡µé¢
        mv.setViewName("error/error");
        return  mv;
    }
}
```



### 3ã€é”™è¯¯é¡µé¢å¼‚å¸¸ä¿¡æ¯æ˜¾ç¤ºå¤„ç†

```html
<div>
    <div th:utext="'&lt;!--'" th:remove="tag"></div>
    <div th:utext="'Failed Request URL :' + ${URL}" th:remove="tag"></div>
    <div th:utext="'Exception message' + ${exception.message}" th:remove="tag"></div>
    <ui th:remove="tag">
        <li th:each="st : ${exception.stackTrace}" th:remove="tag"><span th:utext="${st}" th:remove="tag"></span></li>
    </ui>
    <div th:utext="'--&gt;'" th:remove="tag"></div>
</div>
```

### 4ã€èµ„æºæ‰¾ä¸åˆ°å¼‚å¸¸ç±»

```java
/**
 * è‡ªå®šä¹‰å¼‚å¸¸ç±»
 */
@ResponseStatus(HttpStatus.NOT_FOUND)
public class MyNotFoundException extends RuntimeException {

    public MyNotFoundException() {
    }

    public MyNotFoundException(String message) {
        super(message);
    }

    public MyNotFoundException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

## 7ã€æ—¥å¿—å¤„ç†

> é‡‡ç”¨ aop è¿›è¡Œæ—¥å¿—å¤„ç†

### 1ã€è®°å½•æ—¥å¿—å†…å®¹

- è¯·æ±‚çš„URL
- è®¿é—®è€… ip
- è°ƒç”¨æ–¹æ³• classMethod
- å‚æ•° args
- è¿”å›å†…å®¹



### 2ã€è®°å½•æ—¥å¿—ç±»



```java
package com.wukong.aspect;

import org.aopalliance.intercept.Joinpoint;
import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.annotation.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.servlet.http.HttpServletRequest;
import java.util.Arrays;

/**
 *  aop
 * æ—¥å¿—å¤„ç†
 */
@Aspect
@Component
public class LoginAspect {

    private final Logger logger = LoggerFactory.getLogger(this.getClass());

    /**
     * @Pointcut å®šä¹‰ç®¡ç†åˆ‡å’Œå…¥ç‚¹
     */
    @Pointcut("execution(* com.wukong.web.*.*(..))")
    public void log(){

    }

    /**
     * æ–¹æ³•ä¹‹å‰è¾“å‡º
     */
    @Before("log()")
    public void doBefore(JoinPoint joinpoint){

        //è·å– urlå’Œip
        ServletRequestAttributes attributes =
                (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        HttpServletRequest request = attributes.getRequest();
        String url = request.getRequestURL().toString();
        String ip = request.getRemoteAddr();

        //è·å–ç±»çš„æ–¹æ³•
        String classMethod =
                joinpoint.getSignature().getDeclaringTypeName() + "." +joinpoint.getSignature().getName();
        //è·å–è¯·æ±‚å‚æ•°
        Object[] args = joinpoint.getArgs();

        //å°è£…
        RequestLog requestLog = new RequestLog(url, ip, classMethod, args);

        logger.info("Result : {}",requestLog);
//        logger.info("-----------doBefore--------------");
    }

    /**
     * æ–¹æ³•ä¹‹åè¾“å‡º
     */
    @After("log()")
    public void doAfter(){
//        logger.info("-----------doAfter--------------");
    }

    /**
     * æ–¹æ³•æ‰§è¡Œå®Œè¿”å›çš„å†…å®¹
     */
    @AfterReturning(returning = "result",pointcut = "log()")
    public void doAfterReturn(Object result){
        logger.info("Result : {}", result);
    }

    //å†…éƒ¨ç±»
    public class RequestLog{
        private String url;
        private String ip;
        private String classMethod;
        private Object[] args;

        public RequestLog(String url, String ip, String classMethod, Object[] args) {
            this.url = url;
            this.ip = ip;
            this.classMethod = classMethod;
            this.args = args;
        }

        @Override
        public String toString() {
            return "{" +
                    "url='" + url + '\'' +
                    ", ip='" + ip + '\'' +
                    ", classMethod='" + classMethod + '\'' +
                    ", args=" + Arrays.toString(args) +
                    '}';
        }
    }
}
```

## 8ã€é¡µé¢å¤„ç†

1ã€é™æ€é¡µé¢å¯¼å…¥project

2ã€Thymeleafå¸ƒå±€

- å®šä¹‰fragment
- ä½¿ç”¨fragmentå¸ƒå±€



## =====adminç®¡ç†å‘˜éƒ¨åˆ†=====

## 1ã€å®ä½“è®¾è®¡

- åšå®¢Blog
- åšå®¢åˆ†ç±»Type
- åšå®¢æ ‡ç­¾ Tag
- åšå®¢è¯„è®º Comment
- ç”¨æˆ· User

### 1ã€è¡¨ä¹‹é—´çš„å…³ç³»





![image-20220710112132739](image-20220710112132739.png)

### 2ã€å®ä½“ç±»çš„è®¾è®¡

#### **Blog**



![image-20220709221730008](image-20220709221730008.png)



#### **Tag**

![image-20220709222323056](image-20220709222323056.png)



#### Comment




![image-20220709222536499](image-20220709222536499.png)



#### User

![image-20220709222918593](image-20220709222918593.png)



### 3ã€åˆ†å±‚

  ![image-20220709223704288](image-20220709223704288.png)



### 4ã€å‘½åçº¦å®š

Service/Dao å±‚å‘½åçš„çº¦å®š

- è·å–å•ä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨**get**åšå‰ç¼€
- è·å–å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨**list**åšå‰ç¼€
- è·å–ç»Ÿè®¡å€¼çš„æ–¹æ³•ç”¨Countåšå‰ç¼€
- æ’å…¥çš„æ–¹æ³•ç”¨Save ï¼ˆæ¨èï¼‰æˆ– insertåšå‰ç¼€
- åˆ é™¤çš„æ–¹æ³•ç”¨removeï¼ˆæ¨èï¼‰æˆ–è€…deleteåšå‰ç¼€
- ä¿®æ”¹çš„æ–¹æ³•ç”¨updateåš  



## 2ã€ç™»å½•

1ã€æ„å»ºç™»å½•é¡µé¢å’Œåå°ç®¡ç†é¡µé¢

2ã€UserService å’Œ UserServiceImpl

3ã€LoginControllerå®ç°ç™»å½•

4ã€MD5åŠ å¯†

5ã€ç™»å½•æ‹¦æˆªå™¨

## 3ã€åˆ†ç±»ç®¡ç†

1ã€åˆ†ç±»çš„ç®¡ç†é¡µé¢

2ã€åˆ†ç±»ç±»åˆ«åˆ†é¡µ

3ã€åˆ†ç±»æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤

## 4ã€æ ‡ç­¾ç®¡ç†

1ã€æ ‡ç­¾çš„ç®¡ç†é¡µé¢

2ã€æ ‡ç­¾ç±»åˆ«åˆ†é¡µ

3ã€æ ‡ç­¾æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤



## 5ã€åšå®¢ç®¡ç†

1ã€åšå®¢åˆ†é¡µæŸ¥è¯¢

2ã€åšå®¢æ–°å¢

3ã€åšå®¢ä¿®æ”¹

4ã€åšå®¢åˆ é™¤



## ======å‰æ®µå±•ç¤º=======

### 1ã€åšå®¢é¦–é¡µ

### 2ã€åˆ†ç±»é¡µé¢

### 3ã€æ ‡ç­¾é¡µé¢

### 4ã€å…³äºæˆ‘é¡µé¢

### 5ã€è¯¦æƒ…é¡µé¢

- è¯„è®ºåˆ—è¡¨çš„è®¾è®¡

- è¯„è®ºä¿¡æ¯æäº¤ä¸å›å¤åŠŸèƒ½
- è¯„è®ºä¿¡æ¯åˆ—è¡¨å±•ç¤ºåŠŸèƒ½
- ç®¡ç†å‘˜æ¢å¤è¯„è®ºåŠŸèƒ½





